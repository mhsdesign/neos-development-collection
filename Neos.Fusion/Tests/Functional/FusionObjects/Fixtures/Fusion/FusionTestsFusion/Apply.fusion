prototype(Neos.Fusion:TestRenderer).@class = 'Neos\\Fusion\\Tests\\Functional\\View\\Fixtures\\TestRenderer'
prototype(Neos.Fusion:Value).@class = 'Neos\\Fusion\\FusionObjects\\ValueImplementation'
prototype(Neos.Fusion:Loop).@class = 'Neos\\Fusion\\FusionObjects\\LoopImplementation'
prototype(Neos.Fusion:DataStructure).@class = 'Neos\\Fusion\\FusionObjects\\DataStructureImplementation'
prototype(Neos.Fusion:Join).@class = 'Neos\\Fusion\\FusionObjects\\JoinImplementation'
prototype(Neos.Fusion:Renderer).@class = 'Neos\\Fusion\\FusionObjects\\RendererImplementation'

prototype(Neos.Fusion:EelValue) < prototype(Neos.Fusion:Value) {
  value = ${'original eel expression'}
}

applyTest.rendersOriginalEelExpression {
  @scenario.unchangedEelValue.@after = ${ self.assertSame(actual, 'original eel expression') }

  @provider.noApply = Neos.Fusion:EelValue

  @provider.applyWithStringReturn = Neos.Fusion:EelValue {
    @apply.alterValue = Neos.Fusion:Value {
      value = 'an fusion objects that retuns not an array!!!'
    }
  }

  @provider.renderEelValueWithInvalidExpressionSpread = Neos.Fusion:EelValue {
    @apply.alterValue = ${'an expression but not an array!!!'}
  }
}

applyTest.renderEelValueWithSingleSpread {
  @scenario.changedEelValue.@after = ${ self.assertSame(actual, 'altered eel expression') }

  @provider.applyWithEelObject = Neos.Fusion:EelValue {
    @apply.alterValue = ${{value: 'altered eel expression'}}
  }

  @provider.applyWithFusionObject = Neos.Fusion:EelValue {
    @apply.alterValue = Neos.Fusion:DataStructure {
      value = 'altered eel expression'
    }
  }
}
